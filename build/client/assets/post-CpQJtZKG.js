import{a as v,p as a,w as W,v as K}from"./chunk-WWGJGFF6-CnRWDDMw.js";import{c as F,a as q}from"./compat-DoAXOerC.js";function w(e){return e._type==="span"&&"text"in e&&typeof e.text=="string"&&(e.marks===void 0||Array.isArray(e.marks)&&e.marks.every(t=>typeof t=="string"))}function M(e){return typeof e._type=="string"&&e._type[0]!=="@"&&(!("markDefs"in e)||!e.markDefs||Array.isArray(e.markDefs)&&e.markDefs.every(t=>typeof t._key=="string"))&&"children"in e&&Array.isArray(e.children)&&e.children.every(t=>typeof t=="object"&&"_type"in t)}function N(e){return M(e)&&"listItem"in e&&typeof e.listItem=="string"&&(e.level===void 0||typeof e.level=="number")}function A(e){return e._type==="@list"}function P(e){return e._type==="@span"}function O(e){return e._type==="@text"}const L=["strong","em","code","underline","strike-through"];function H(e,t,n){if(!w(e)||!e.marks||!e.marks.length)return[];let l=e.marks.slice(),o={};return l.forEach(r=>{o[r]=1;for(let u=t+1;u<n.length;u++){let c=n[u];if(c&&w(c)&&Array.isArray(c.marks)&&c.marks.indexOf(r)!==-1)o[r]++;else break}}),l.sort((r,u)=>R(o,r,u))}function R(e,t,n){let l=e[t],o=e[n];if(l!==o)return o-l;let r=L.indexOf(t),u=L.indexOf(n);return r===u?t.localeCompare(n):r-u}function z(e){let{children:t}=e,n=e.markDefs??[];if(!t||!t.length)return[];let l=t.map(H),o={_type:"@span",children:[],markType:"<unknown>"},r=[o];for(let u=0;u<t.length;u++){let c=t[u];if(!c)continue;let d=l[u]||[],I=1;if(r.length>1)for(;I<r.length;I++){let i=r[I]?.markKey||"",s=d.indexOf(i);if(s===-1)break;d.splice(s,1)}r=r.slice(0,I);let x=r[r.length-1];if(x){for(let i of d){let s=n?.find(k=>k._key===i),y={_type:"@span",_key:c._key,children:[],markDef:s,markType:s?s._type:i,markKey:i};x.children.push(y),r.push(y),x=y}if(w(c)){let i=c.text.split(`
`);for(let s=i.length;s-- >1;)i.splice(s,0,`
`);x.children=x.children.concat(i.map(s=>({_type:"@text",text:s})))}else x.children=x.children.concat(c)}}return o.children}function V(e,t){let n=[],l;for(let o=0;o<e.length;o++){let r=e[o];if(r){if(!N(r)){n.push(r),l=void 0;continue}if(!l){l=j(r,o,t),n.push(l);continue}if(G(r,l)){l.children.push(r);continue}if((r.level||1)>l.level){let u=j(r,o,t);if(t==="html"){let c=l.children[l.children.length-1],d={...c,children:[...c.children,u]};l.children[l.children.length-1]=d}else l.children.push(u);l=u;continue}if((r.level||1)<l.level){let u=n[n.length-1],c=u&&T(u,r);if(c){l=c,l.children.push(r);continue}l=j(r,o,t),n.push(l);continue}if(r.listItem!==l.listItem){let u=n[n.length-1],c=u&&T(u,{level:r.level||1});if(c&&c.listItem===r.listItem){l=c,l.children.push(r);continue}else{l=j(r,o,t),n.push(l);continue}}console.warn("Unknown state encountered for block",r),n.push(r)}}return n}function G(e,t){return(e.level||1)===t.level&&e.listItem===t.listItem}function j(e,t,n){return{_type:"@list",_key:`${e._key||`${t}`}-parent`,mode:n,level:e.level||1,listItem:e.listItem,children:[e]}}function T(e,t){let n=t.level||1,l=t.listItem||"normal",o=typeof t.listItem=="string";if(A(e)&&(e.level||1)===n&&o&&(e.listItem||"normal")===l)return e;if(!("children"in e))return;let r=e.children[e.children.length-1];return r&&!w(r)?T(r,t):void 0}function C(e){let t="";return e.children.forEach(n=>{O(n)?t+=n.text:P(n)&&(t+=C(n))}),t}const J="html",Q={number:({children:e})=>a.jsx("ol",{children:e}),bullet:({children:e})=>a.jsx("ul",{children:e})},X=({children:e})=>a.jsx("li",{children:e}),Y=({children:e,value:t})=>a.jsx("a",{href:t?.href,children:e}),Z={textDecoration:"underline"},ee={em:({children:e})=>a.jsx("em",{children:e}),strong:({children:e})=>a.jsx("strong",{children:e}),code:({children:e})=>a.jsx("code",{children:e}),underline:({children:e})=>a.jsx("span",{style:Z,children:e}),"strike-through":({children:e})=>a.jsx("del",{children:e}),link:Y},_=(e,t)=>`[@portabletext/react] Unknown ${e}, specify a component for it in the \`components.${t}\` prop`,E=e=>_(`block type "${e}"`,"types"),te=e=>_(`mark type "${e}"`,"marks"),ne=e=>_(`block style "${e}"`,"block"),le=e=>_(`list style "${e}"`,"list"),re=e=>_(`list item style "${e}"`,"listItem");function ie(e){console.warn(e)}const se={display:"none"},S={types:{},block:{normal:({children:e})=>a.jsx("p",{children:e}),blockquote:({children:e})=>a.jsx("blockquote",{children:e}),h1:({children:e})=>a.jsx("h1",{children:e}),h2:({children:e})=>a.jsx("h2",{children:e}),h3:({children:e})=>a.jsx("h3",{children:e}),h4:({children:e})=>a.jsx("h4",{children:e}),h5:({children:e})=>a.jsx("h5",{children:e}),h6:({children:e})=>a.jsx("h6",{children:e})},marks:ee,list:Q,listItem:X,hardBreak:()=>a.jsx("br",{}),unknownType:({value:e,isInline:t})=>{let n=E(e._type);return a.jsx(t?"span":"div",{style:se,children:n})},unknownMark:({markType:e,children:t})=>a.jsx("span",{className:`unknown__pt__mark__${e}`,children:t}),unknownList:({children:e})=>a.jsx("ul",{children:e}),unknownListItem:({children:e})=>a.jsx("li",{children:e}),unknownBlockStyle:({children:e})=>a.jsx("p",{children:e})};function ae(e,t){let{block:n,list:l,listItem:o,marks:r,types:u,...c}=t;return{...e,block:g(e,t,"block"),list:g(e,t,"list"),listItem:g(e,t,"listItem"),marks:g(e,t,"marks"),types:g(e,t,"types"),...c}}function g(e,t,n){let l=t[n],o=e[n];return typeof l=="function"||l&&typeof o=="function"?l:l?{...o,...l}:o}function oe({value:e,components:t,listNestingMode:n,onMissingComponent:l=ie}){let o=l||ce,r=V(Array.isArray(e)?e:[e],n||J),u=v.useMemo(()=>t?ae(S,t):S,[t]),c=v.useMemo(()=>ue(u,o),[u,o]);return a.jsx(a.Fragment,{children:r.map((d,I)=>c({node:d,index:I,isInline:!1,renderNode:c}))})}const ue=(e,t)=>{function n(i){let{node:s,index:y,isInline:k}=i,f=s._key||`node-${y}`;return A(s)?r(s,y,f):N(s)?o(s,y,f):P(s)?u(s,y,f):l(s)?x(s,y,f,k):M(s)?c(s,y,f,k):O(s)?d(s,f):I(s,y,f,k)}function l(i){return i._type in e.types}function o(i,s,y){let k=B({node:i,index:s,isInline:!1,renderNode:n}),f=e.listItem,m=(typeof f=="function"?f:f[i.listItem])||e.unknownListItem;if(m===e.unknownListItem){let h=i.listItem||"bullet";t(re(h),{type:h,nodeType:"listItemStyle"})}let p=k.children;if(i.style&&i.style!=="normal"){let{listItem:h,...b}=i;p=n({node:b,index:s,isInline:!1})}return a.jsx(m,{value:i,index:s,isInline:!1,renderNode:n,children:p},y)}function r(i,s,y){let k=i.children.map((p,h)=>n({node:p._key?p:{...p,_key:`li-${s}-${h}`},index:h,isInline:!1})),f=e.list,m=(typeof f=="function"?f:f[i.listItem])||e.unknownList;if(m===e.unknownList){let p=i.listItem||"bullet";t(le(p),{nodeType:"listStyle",type:p})}return a.jsx(m,{value:i,index:s,isInline:!1,renderNode:n,children:k},y)}function u(i,s,y){let{markDef:k,markType:f,markKey:m}=i,p=e.marks[f]||e.unknownMark,h=i.children.map((b,U)=>n({node:b,index:U,isInline:!0}));return p===e.unknownMark&&t(te(f),{nodeType:"mark",type:f}),a.jsx(p,{text:C(i),value:k,markType:f,markKey:m,renderNode:n,children:h},y)}function c(i,s,y,k){let{_key:f,...m}=B({node:i,index:s,isInline:k,renderNode:n}),p=m.node.style||"normal",h=(typeof e.block=="function"?e.block:e.block[p])||e.unknownBlockStyle;return h===e.unknownBlockStyle&&t(ne(p),{nodeType:"blockStyle",type:p}),a.jsx(h,{...m,value:m.node,renderNode:n},y)}function d(i,s){if(i.text===`
`){let y=e.hardBreak;return y?a.jsx(y,{},s):`
`}return i.text}function I(i,s,y,k){let f={value:i,isInline:k,index:s,renderNode:n};t(E(i._type),{nodeType:"block",type:i._type});let m=e.unknownType;return a.jsx(m,{...f},y)}function x(i,s,y,k){let f={value:i,isInline:k,index:s,renderNode:n},m=e.types[i._type];return m?a.jsx(m,{...f},y):null}return n};function B(e){let{node:t,index:n,isInline:l,renderNode:o}=e,r=z(t).map((u,c)=>o({node:u,isInline:!0,index:c,renderNode:o}));return{_key:t._key||`block-${n}`,children:r,index:n,isInline:l,node:t}}function ce(){}const{projectId:D,dataset:$}=F.config(),ye=e=>D&&$?q({projectId:D,dataset:$}).image(e):null,me=W(function({loaderData:t}){const{post:n}=t,l=n.mainImage?ye(n.mainImage)?.width(550).url():null;return a.jsxs("main",{className:"container mx-auto min-h-screen max-w-3xl p-8 flex flex-col gap-4",children:[a.jsx(K,{to:"/",className:"hover:underline text-gray-600",children:"← Back to posts"}),a.jsx("h1",{className:"text-4xl font-bold mt-4",children:n.title}),a.jsxs("p",{className:"text-sm text-gray-500",children:[n.category?.title," • ",n.readTime," • ",new Date(n.publishedAt).toLocaleDateString()]}),l&&a.jsx("img",{src:l,alt:n.title,className:"rounded-xl mt-4"}),a.jsx("div",{className:"prose mt-4",children:Array.isArray(n.body)&&a.jsx(oe,{value:n.body})})]})});export{me as default};
